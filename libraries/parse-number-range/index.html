<!DOCTYPE html>

<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="author" content="Jean-Philippe Paradis" />
    <link rel="author" href="http://www.hexstreamsoft.com/introduction.html" />
    <link rel="license" href="http://www.hexstreamsoft.com/UNLICENSE" />
    <link rel="next" href="../bubble-operator-upwards/" />
    <meta name="description" content="Parses LOOP's convenient for-as-arithmetic syntax into 5 simple values: from, to, limit-kind (:inclusive, :exclusive or nil if unbounded), by (step) and direction (+ or -))." />
    <title>parse-number-range | Libraries | HexstreamSoft</title>
    <link href="../../css/global.css" rel="stylesheet" type="text/css" />
    <link href="../libraries.css" rel="stylesheet" type="text/css" />
    <script src="https://use.edgefonts.net/sanvito-pro-display.js"></script>
  </head>
  <body>

    <nav id="site-nav">

      <nav class="breadcrumbs-and-extras">

        <nav class="breadcrumbs">
          <a href="../../">HexstreamSoft</a>
          <span class="separator"> » </span>
          <a href="../">Libraries</a>
          <span class="separator"> » </span>
          <a href="../#macros">Macros</a>
          <span class="separator"> » </span>
          <a href="../#macro-utilities">Utilities</a>
          <span class="separator"> » </span>
          <a class="here">parse-number-range</a>
          <div class="float-clear"></div>
        </nav>

        <nav id="meta-nav">
          <a href="http://www.hexstreamsoft.com/libraries/parse-number-range/">
            <abbr title="Canonical">C</abbr>
          </a>
          <a href="https://github.com/Hexstream/hexstreamsoft.com/blob/master/libraries/parse-number-range/index.html">
            <abbr title="Source">S</abbr>
          </a>
          <a href="http://worknotes.hexstreamsoft.com/libraries/parse-number-range/">
            <abbr title="Worknotes">W</abbr>
          </a>
        </nav>

        <nav>
          <a class="sequential-link prev" href="../multiple-value-variants/">⇤</a>
          <a href="../">
            Libraries
            <span>10/15   1/2</span>
          </a>
          <a class="sequential-link next" href="../bubble-operator-upwards/">→</a>
        </nav>

        <nav>
          <a class="sequential-link prev" href="../multiple-value-variants/">←</a>
          <a href="../">
            Categories
            <span>3/5</span>
          </a>
          <a class="sequential-link next" href="../incognito-keywords/">→</a>
        </nav>

        <div class="float-clear"></div>

      </nav>


      <nav class="ancestors-nav">

        <div class="level-separator"></div>

        <nav class="navbox empty" id="library_navbox">
          <h1>
            <a class="here">parse-number-range</a>
            <span class="here-indicator-left"> </span>
            <span class="here-indicator-right"> </span>
          </h1>
        </nav>

        <div class="level-separator"></div>

        <nav class="navbox">
          <h1>
            <a href="../#macro-utilities">Macro utilities</a>
          </h1>
          <ul>
            <li>
              <a class="here">
                parse-number-range
                <span class="here-indicator-left"> </span>
                <span class="here-indicator-right"> </span>
              </a>
            </li>
            <li><a href="../bubble-operator-upwards/">bubble-operator-upwards</a></li>
          </ul>
        </nav>

        <div class="level-separator"></div>

        <nav class="navbox">
          <h1>
            <a href="../#macros">Macros</a>
          </h1>
          <ul>
            <li><a href="../#simple-macros">Simple</a></li>
            <li><a href="../#extensible-macros">Extensible</a></li>
            <li>
              <a href="../#macro-utilities">
                Utilities
                <span class="here-indicator-left"> </span>
                <span class="here-indicator-right"> </span>
              </a>
            </li>
          </ul>
        </nav>

        <div class="level-separator"></div>

        <nav class="navbox">
          <h1 class="box-header">
            <a href="../">Libraries</a>
          </h1>
          <ul>
            <li>
              <a href="../#macros">
                Macros
                <span class="here-indicator-left"> </span>
                <span class="here-indicator-right"></span>
              </a>
            </li>
            <li><a href="../#data-structures">Data structures</a></li>
            <li><a href="../#uncategorized">Uncategorized</a></li>
          </ul>
          <ul>
            <li><a href="../releases/">Releases</a></li>
          </ul>
        </nav>

        <div class="level-separator"></div>

        <nav class="navbox" id="main_navbox">
          <h1>
            <a href="../../">HexstreamSoft</a>
          </h1>
          <ul>
            <li><a href="../">Libraries <span class="here-indicator-left"> </span> <span class="here-indicator-right"> </span></a></li>
            <li><a href="../../articles/">Articles</a></li>
            <li><a href="../../accounts/">Accounts</a></li>
            <li><a href="../../resources/">Resources</a></li>
          </ul>
          <ul>
            <li><a href="http://worknotes.hexstreamsoft.com/">Worknotes</a></li>
            <li><a href="http://status-quo.hexstreamsoft.com/">Status quo</a></li>
          </ul>
        </nav>

      </nav>

    </nav>

    <main>
      <header id="page-header">
        <h1>parse-number-range</h1>
        <p class="description">A simple thematic utilities library in Quicklisp.</p>
      </header>

      <div id="project-info">
        <table class="factsheet">
          <tbody>
            <tr>
              <th class="project-author property">Project author</th>
              <td class="project-author" colspan="2"><a href="../../introduction.html">Jean-Philippe Paradis</a></td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="project-type property">Project type</th>
              <td class="project-type" colspan="2">Library</td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="library-programming-language property">Programming language</th>
              <td class="library-programming-language" colspan="2">Common Lisp</td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="project-status property">Status</th>
              <td class="project-status good-news" colspan="2">Ready-to-use</td>
            </tr>
            <tr>
              <th class="project-license property"><a href="https://github.com/Hexstream/parse-number-range/blob/master/UNLICENSE">License</a></th>
              <td class="project-license good-news" colspan="2"><a href="../../resources/#unlicense">Public Domain</a></td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="library-type property">Library type</th>
              <td class="library-type" colspan="2">Thematic utilities</td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="project-complexity property">Project complexity</th>
              <td class="project-complexity" colspan="2">Simple</td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="project-latest-release" rowspan="2"><a href="http://tarballs.hexstreamsoft.com/libraries/latest/parse-number-range_latest.tar.gz">Latest release</a></th>
              <th class="project-latest-release-version property">Version</th>
              <td class="project-latest-release-version">1.0</td>
            </tr>
            <tr>
              <th class="project-latest-release-date property">Date</th>
              <td class="project-latest-release-date">26 oct 2012</td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="project-quicklisp" rowspan="2">
                Quicklisp
                <br />
                <span class="as-of-dist">(<a href="http://blog.quicklisp.org/2012/11/november-2012-quicklisp-dist-update-now.html">Nov 2012 dist</a> and later)</span>
              </th>
              <th class="project-quicklisp-status property">Status</th>
              <td class="project-quicklisp-status good-news">Available</td>
            </tr>
            <tr>
              <th class="project-quicklisp-version property">Version</th>
              <td class="project-quicklisp-version good-news">Latest</td>
            </tr>
          </tbody>

        </table>

        <nav class="navbox" id="external-projects_navbox">
          <h1>
            External library pages
          </h1>
          <ul>
            <li><a href="http://github.com/Hexstream/parse-number-range">Github</a></li>
            <li><a href="http://quickdocs.org/parse-number-range">Quickdocs</a></li>
            <li><a href="http://cliki.net/parse-number-range">CLiki</a></li>
            <li><a href="http://common-lisp.net/project/cl-test-grid/library/parse-number-range.html">cl-test-grid</a></li>
          </ul>
        </nav>

        <table id="dependencies-table">
          <thead>
            <tr>
              <th></th>
              <th>Depends on</th>
              <th>Depended on by</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th>Directly</th>
              <td>
                <ul>
                  <li><a href="../map-bind/">map-bind</a></li>
                  <li><a href="../enhanced-multiple-value-bind/">enhanced-multiple-value-bind</a></li>
                  <li><a href="../cartesian-product-switch/">cartesian-product-switch</a></li>
                </ul>
              </td>
              <td>Nothing</td>
            </tr>
            <tr>
              <th>Indirectly</th>
              <td>Nothing</td>
              <td>Nothing</td>
            </tr>
          </tbody>
        </table>

      </div>

      <p><cite class="common-lisp library">parse-number-range</cite> parses <code class="common-lisp standard macro operator"><a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_loop.htm">loop</a></code>'s convenient <a href="http://www.lispworks.com/documentation/HyperSpec/Body/06_abaa.htm">for-as-arithmetic</a> syntax into 5 simple values: <var>from</var>, <var>to</var>, <var>limit-kind</var> (<code class="common-lisp library marker">:inclusive</code>, <code class="common-lisp library marker">:exclusive</code> or <code class="common-lisp library marker">nil</code> if unbounded), <var>by</var> (step) and <var>direction</var> (<code class="common-lisp library marker">+</code> or <code class="common-lisp library marker">-</code>)). Further related utilities are provided. Intended for easy implementation of analogous functionality in other constructs.</p>

      <p>Here's the package name, along with 2 nicknames:</p>

      <ul>
        <li><code class="common-lisp library package">parse-number-range</code></li>
        <li><code class="common-lisp library package">parse-numrange</code></li>
        <li><code class="common-lisp library package">pnumrange</code></li>
      </ul>

      <p>Explicit qualification of the exported symbols is recommended, and one might <code class="common-lisp">(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defpkg.htm">:import-from</a>)</code> select symbols, but <code class="common-lisp">(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defpkg.htm">:use</a>)</code> is strongly discouraged.</p>

      <section id="api">

        <h1 class="breadcrumbs">
          <a href="#api" class="anchor">⚓</a>
          <a href="#">parse-number-range</a>
          <span class="separator"> » </span>
          <a class="here">API</a>
        </h1>

        <section id="api-generalities">

          <h1 class="breadcrumbs">
            <a href="#api" class="anchor">⚓</a>
            <a href="#">parse-number-range</a>
            <span class="separator"> » </span>
            <a href="#api">API</a>
            <span class="separator"> » </span>
            <a class="here">Generalities</a>
          </h1>

          Here are the 5 "fundamental" values returned from <code class="common-lisp library function operator">parse</code> and accepted by <code class="common-lisp library function operator">unparse</code>:

          <dl>

            <dt><dfn><var>from</var></dfn></dt>
            <dd><p>The <a class="common-lisp glossary" href="http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_f.htm#form">form</a> introduced by <code class="common-lisp library marker">:from</code>, <code class="common-lisp library marker">:upfrom</code> or <code class="common-lisp library marker">:downfrom</code>. Defaults to 0;</p></dd>

            <dt><dfn><var>to</var></dfn></dt>
            <dd><p>The <a class="common-lisp glossary" href="http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_f.htm#form">form</a> introduced by <code class="common-lisp library marker">:to</code>, <code class="common-lisp library marker">:upto</code>, <code class="common-lisp library marker">:downto</code>, <code class="common-lisp library marker">:below</code> or <code class="common-lisp library marker">:above</code>. <code class="common-lisp library marker">nil</code> means "unbounded";</p></dd>

            <dt><dfn><var>limit-kind</var></dfn></dt>
            <dd><p><code class="common-lisp library marker">:inclusive</code> or <code class="common-lisp library marker">:exclusive</code> if there's a limit, or <code class="common-lisp library marker">nil</code> if unbounded;</p></dd>

            <dt><dfn><var>by</var></dfn></dt>
            <dd><p>The <a class="common-lisp glossary" href="http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_f.htm#form">form</a> introduced by <code class="common-lisp library marker">:by</code>;</p></dd>

            <dt><dfn><var>direction</var></dfn></dt>
            <dd><p><code class="common-lisp library marker">+</code> or <code class="common-lisp library marker">-</code>.</p></dd>

          </dl>

          Some functions accept a <var>keyword-policy</var> &amp;key argument, which must be either <code class="common-lisp library marker">:strict</code> or <code class="common-lisp library marker">:loose</code>. <code class="common-lisp">(from 1 to 10)</code> would be valid with <code class="common-lisp library marker">:loose</code> but not with <code class="common-lisp library marker">:strict</code>, which demands <code class="common-lisp">(:from 1 :to 10)</code>.

          <strong>Use of <code class="common-lisp library marker">:loose</code> is strongly discouraged</strong>, as it's an unnecessary and evil feature that typically results in arbitrary interning of symbols in arbitrary packages.

        </section>

        <section id="parse-api">

          <h1 class="breadcrumbs">
            <a href="#parse-api" class="anchor">⚓</a>
            <a href="#">parse-number-range</a>
            <span class="separator"> » </span>
            <a href="#api">API</a>
            <span class="separator"> » </span>
            <a class="here">Parse API</a>
          </h1>

          <dl>
            <dt><pre>Function <dfn><code class="common-lisp library function operator">parse</code></dfn> <var>range</var> &amp;key (<var>keyword-policy</var> <code class="common-lisp library marker">:strict</code>)
                          (<var>extrasp</var> nil)
                          (<var>clause-kinds-p</var> <var>extrasp</var>)
                          (<var>clause-keywords-p</var> <var>extrasp</var>)
                          (<var>clauses-alist-p</var> <var>extrasp</var>)
  =&gt; <var>from</var> <var>to</var> <var>limit-kind</var> <var>by</var> <var>direction</var>
       &amp;key <var>clause-kinds</var> <var>clause-keywords</var> <var>clauses-alist</var></pre></dt>
            <dd><p>By default, <code class="common-lisp library function operator">parse</code> returns only the 5 "fundamental" values (see above):</p>

              <dl>

                <dt><dfn><var>from</var></dfn></dt>
                <dd><p>Defaults to 0;</p></dd>

                <dt><dfn><var>to</var></dfn></dt>
                <dd><p>Defaults to <code class="common-lisp library marker">nil</code>;</p></dd>

                <dt><dfn><var>limit-kind</var></dfn></dt>
                <dd><p>Defaults to <code class="common-lisp library marker">nil</code> (unbounded);</p></dd>

                <dt><dfn><var>by</var></dfn></dt>
                <dd><p>Defaults to 1;</p></dd>

                <dt><dfn><var>direction</var></dfn></dt>
                <dd><p>Defaults to <code class="common-lisp library marker">+</code>.</p></dd>

              </dl>

              <p><code class="common-lisp library function operator">parse</code> can compute and return 3 additional pieces of information, on request:</p>

              <table>
                <thead>
                  <tr>
                    <th>return value</th>
                    <th>request-keyword</th>
                    <th>description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th><var>clause-kinds</var></th>
                    <td>:clause-kinds-p</td>
                    <td><p>The clause kinds that were present,<br />in the order they appeared in.</p></td>
                  </tr>
                  <tr>
                    <th><var>clause-keywords</var></th>
                    <td>:clause-keywords-p</td>
                    <td><p>The clause keywords that were present,<br />in the order they appeared in.</p></td>
                  </tr>
                  <tr>
                    <th><var>clauses-alist</var></th>
                    <td>:clauses-alist-p</td>
                    <td><p>Alist: (<var>clause-kind</var> . <var>clause-keyword</var>)</p></td>
                  </tr>
                </tbody>
              </table>
            </dd>

            <dt><pre>Function <dfn><code class="common-lisp library function operator">unparse</code></dfn> <var>from</var> <var>to</var> <var>limit-kind</var> <var>by</var> <var>direction</var> &amp;key <var>clause-kinds</var>
  =&gt; <var>range</var></pre></dt>

            <dd>
              <p>As you might have guessed, this does the reverse of <code class="common-lisp library function operator">parse</code>...</p>

              <p><code class="common-lisp library function operator">unparse</code> uses <code class="common-lisp library function operator">flags-to-keywords</code> internally and thus inherits its biases.</p>

              <p><var>clause-kinds</var> should be a list of up to 3 elements being a permutation of the clause-kinds <code class="common-lisp library marker">:from</code>, <code class="common-lisp library marker">:to</code> and <code class="common-lisp library marker">:by</code>. This determines the order that the clauses will appear in, which might matter in the presence of side-effects. <code class="common-lisp library marker">nil</code> designates the default order, <code class="common-lisp">(<code class="common-lisp library marker">:from</code> <code class="common-lisp library marker">:to</code> <code class="common-lisp library marker">:by</code>)</code>.</p>

              <p>If the list has 0 or 1 elements, then the default order is used, <code class="common-lisp">(<code class="common-lisp library marker">:from</code> <code class="common-lisp library marker">:to</code> <code class="common-lisp library marker">:by</code>)</code>.</p>

              <p>If the list has 2 elements, then those clauses will appear in the order specified but no order is specified between the other elements and these ones and between the other elements among themselves. <small>(Yeah, a less simplistic implementation would allow simpler and more useful semantics.)</small></p>

              <p>If the list has 3 elements, then the order is completely specified, explicitly.</p>
            </dd>

            <dt><pre>Function <dfn><code class="common-lisp library function operator">canonicalize</code></dfn> <var>range</var> &amp;key (<var>clause-kinds</var> <code class="common-lisp library marker">:preserve</code>)
                                 (<var>keyword-policy</var> <code class="common-lisp library marker">:strict</code>)</pre></dt>

            <dd><p>This simply feeds the results of <code class="common-lisp library function operator">parse</code> into <code class="common-lisp library function operator">unparse</code>. If <var>clause-kinds</var> is <code class="common-lisp library marker">:preserve</code>, then <code class="common-lisp">:clause-kinds-p t</code> will be specified for <code class="common-lisp library function operator">parse</code> and the resulting <var>clause-kinds</var> result will be fed to <code class="common-lisp library function operator">unparse</code>. Else, the provided <var>clause-kinds</var> is fed directly to <code class="common-lisp library function operator">unparse</code>.</p></dd>

          </dl>

        </section>

        <section id="info-api">

          <h1 class="breadcrumbs">
            <a href="#api" class="anchor">⚓</a>
            <a href="#">parse-number-range</a>
            <span class="separator"> » </span>
            <a href="#api">API</a>
            <span class="separator"> » </span>
            <a class="here">Info API</a>
          </h1>

          <dl>
            <dt><pre>Function <dfn><code class="common-lisp library function operator">kind</code></dfn> <var>keyword</var> &amp;key (<var>errorp</var> t) (<var>keyword-policy</var> <code class="common-lisp library marker">:strict</code>)
                =&gt; <var>kind</var> <var>direction</var> <var>limit-kind</var></pre></dt>

            <dd><p>This function takes a <code class="common-lisp standard macro operator"><a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_loop.htm">loop</a></code> keyword and returns the following information:</p>

              <table>
                <thead>
                  <tr>
                    <th>Argument</th>
                    <th colspan="3">Return values</th>
                  </tr>
                  <tr>
                    <th><var>keyword</var></th>
                    <th><var>kind</var></th>
                    <th><var>direction</var></th>
                    <th><var>limit-kind</var></th>
                  </tr>
                </thead>
                <tbody>
                  <tr><th>:from</th><td>:from</td><td>nil</td><td>nil</td></tr>
                  <tr><th>:downfrom</th><td>:from</td><td>-</td><td>nil</td></tr>
                  <tr><th>:upfrom</th><td>:from</td><td>+</td><td>nil</td></tr>
                </tbody>
                <tbody>
                  <tr><th>:to</th><td>:to</td><td>nil</td><td>:inclusive</td></tr>
                  <tr><th>:upto</th><td>:to</td><td>+</td><td>:inclusive</td></tr>
                  <tr><th>:downto</th><td>:to</td><td>-</td><td>:inclusive</td></tr>
                  <tr><th>:below</th><td>:to</td><td>+</td><td>:exclusive</td></tr>
                  <tr><th>:above</th><td>:to</td><td>-</td><td>:exclusive</td></tr>
                </tbody>
                <tbody>
                  <tr><th>:by</th><td>:by</td><td>nil</td><td>nil</td></tr>
                </tbody>
              </table>
            </dd>


            <dt><pre>Function <dfn><code class="common-lisp library function operator">flags</code></dfn> <var>keyword</var> &amp;key (<var>errorp</var> t) (<var>keyword-policy</var> <code class="common-lisp library marker">:strict</code>)
  =&gt; <var>direction</var> <var>limit-kind</var></pre></dt>

            <dd><p>This convenience function simply forwards to <code class="common-lisp library function operator">kind</code> and returns all values but the first.</p></dd>


            <dt><pre>Function <dfn><code class="common-lisp library function operator">flags-to-keywords</code></dfn> <var>direction</var> <var>limit-kind</var>
  =&gt; <var>from-keyword</var> <var>to-keyword</var></pre></dt>

            <dd>

              <p>This function does roughly the opposite of the KIND function. It returns a FROM-KEYWORD and a TO-KEYWORD (nil if unbounded) that properly indicate the supplied DIRECTION and LIMIT-KIND.</p>

              <p>There are typically multiple valid sets of answers that could be returned. This function is currently biased as follows, with no way to request a different bias:</p>

              <ul>
                <li>
                  <p>The <var>direction</var> and <var>limit-kind</var> will always be represented in the <var>to-keyword</var>, and never in the <var>from-keyword</var>, except for the following exception:</p>
                  <pre class="example"><code class="common-lisp">(flags-to-keywords '- :exclusive) =&gt; :downfrom, nil</code></pre>
                </li>
                <li><p>:to is always returned in preference to :upto.</p></li>
              </ul>

            </dd>

          </dl>

        </section>

      </section>

    </main>

    <footer id="footer">
      <div>
        <a href="#" class="back-to-top">⬆</a>
        <span class="page-badge"><a href="http://validator.w3.org/check?uri=http%3A%2F%2Fwww.hexstreamsoft.com%2Flibraries%2Fparse-number-range%2F"><span class="checkmark">✔</span> HTML5</a></span>
        <span class="page-badge"><a href="http://www.hexstreamsoft.com/README"><span class="checkmark">✔</span> Public Domain</a></span>
        <span class="page-badge"><a href="http://jigsaw.w3.org/css-validator/validator?uri=http%3A%2F%2Fwww.hexstreamsoft.com%2Flibraries%2Fparse-number-range%2F"><span class="checkmark">✔</span> CSS3</a></span>
      </div>
    </footer>

  </body>
</html>
