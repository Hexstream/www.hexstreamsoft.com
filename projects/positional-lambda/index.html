<!DOCTYPE html>

<html>
  <head>
    <meta charset="UTF-8" />
    <title>positional-lambda | Projects | HexstreamSoft</title>
    <link href="../../global.css" rel="stylesheet" type="text/css" />
    <link href="../projects.css" rel="stylesheet" type="text/css" />
    <script src="http://use.edgefonts.net/sanvito-pro-display.js"></script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-1783234-3']);
      _gaq.push(['_trackPageview']);

      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>
  <body>

    <p id="crumbs">
      <a href="../../">HexstreamSoft</a>
      <span class="separator"> → </span>
      <a href="../">Projects</a>
      <span class="separator"> → </span>
      <a class="here">positional-lambda</a>
    </p>

    <nav class="ancestors-nav">

      <div class="level-separator"></div>

      <nav class="navbox" id="simple-macro-projects_navbox">
        <h1 class="box-header">
          <a href="../macros/simple/">Simple macros</a>
        </h1>
        <ul>
          <li><a href="../map-bind/">map-bind</a></li>
          <li><a class="here">positional-lambda <span class="here-indicator-left"> </span> <span class="here-indicator-right"> </span></a></li>
          <li><a href="../enhanced-eval-when/">enhanced-eval-when</a></li>
          <li><a href="../enhanced-multiple-value-bind/">enhanced-multiple-value-bind</a></li>
          <li><a href="../macro-level/">macro-level</a></li>
        </ul>
      </nav>

      <div class="level-separator"></div>

      <nav class="navbox" id="macros_projects_navbox">
        <h1>
          <a href="../macros/">Macros</a>
        </h1>
        <ul>
          <li><a href="../macros/simple/">Simple <span class="here-indicator-left"> </span> <span class="here-indicator-right"> </span></a></li>
          <li><a href="../macros/extensible/">Extensible</a></li>
          <li><a href="../macros/utilities/">Utilities</a></li>
        </ul>
      </nav>

      <div class="level-separator"></div>

      <nav class="navbox" id="projects_navbox">
        <h1 class="box-header">
          <a href="../">Projects</a>
        </h1>
        <ul>
          <li><a href="../macros/">Macros <span class="here-indicator-left"> </span> <span class="here-indicator-right"></span></a></li>
          <li><a href="../data-structures/">Data structures</a></li>
          <li><a href="../uncategorized/">Uncategorized</a></li>
        </ul>
      </nav>

      <div class="level-separator"></div>

      <nav class="navbox" id="main_navbox">
        <h1>
          <a href="../">HexstreamSoft</a>
        </h1>
        <ul>
          <li><a href="../../introduction.html">Introduction</a></li>
          <li><a href="../">Projects <span class="here-indicator-left"> </span> <span class="here-indicator-right"> </span></a></li>
          <li><a href="../../tweets/">Tweets</a></li>
          <li><a href="../../worknotes/">Worknotes</a></li>
          <li><a href="../../accounts/">Accounts</a></li>
          <li><a href="../../resources/">Resources</a></li>
        </ul>
      </nav>

    </nav>

    <div id="content">
      <header id="page-header">
        <h1>positional-lambda</h1>
        <p class="description">A simple (but crucial) concision macro in Quicklisp.</p>
      </header>

      <div id="project-info">
        <table class="factsheet">
          <tbody>
            <tr>
              <th class="project-type property">Project Type</th>
              <td class="project-type" colspan="2">Library</td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="library-programming-language property">Programming language</th>
              <td class="library-programming-language" colspan="2">Common Lisp</td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="project-status property">Status</th>
              <td class="project-status good-news" colspan="2">Ready-to-use</td>
            </tr>
            <tr>
              <th class="project-license property"><a href="https://github.com/Hexstream/positional-lambda/blob/master/UNLICENSE">License</a></th>
              <td class="project-license good-news" colspan="2"><a href="../../resources/#unlicense">Public Domain</a></td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="library-type property">Library type</th>
              <td class="library-type" colspan="2">Concision macro</td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="project-complexity property">Project complexity</th>
              <td class="project-complexity" colspan="2">Simple</td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="project-latest-release" rowspan="2"><a href="positional-lambda_latest.tar.gz">Latest release</a></th>
              <th class="project-latest-release-version property">Version</th>
              <td class="project-latest-release-version">2.0</td>
            </tr>
            <tr>
              <th class="project-latest-release-date property">Date</th>
              <td class="project-latest-release-date">30 sept 2012</td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <th class="project-quicklisp" rowspan="2">
                Quicklisp
                <br />
                <span class="as-of-dist">(<a href="http://blog.quicklisp.org/2012/10/october-2012-dist-update-now-available.html">Oct 2012 dist</a> and later)</span>
              </th>
              <th class="project-quicklisp-status property">Status</th>
              <td class="project-quicklisp-status good-news">Available</td>
            </tr>
            <tr>
              <th class="project-quicklisp-version property">Version</th>
              <td class="project-quicklisp-version good-news">Latest</td>
            </tr>
          </tbody>

        </table>

        <nav class="navbox" id="external-projects_navbox">
          <h1>
            External project pages
          </h1>
          <ul>
            <li><a href="http://github.com/Hexstream/positional-lambda">Github</a></li>
            <li><a href="http://quickdocs.org/positional-lambda">Quickdocs</a></li>
            <li><a href="http://cliki.net/positional-lambda">CLiki</a></li>
            <li><a href="http://common-lisp.net/project/cl-test-grid/library/positional-lambda.html">cl-test-grid</a></li>
          </ul>
        </nav>

      </div>

      <p>positional-lambda is a concise, intuitive and flexible syntax (macro) for trivial lambdas that eschews explicit (and often contextually-redundant) naming of parameter variables in favor of positional references, with support for a used or ignored &amp;rest parameter and automatic declaration of ignored parameters when logical "gaps" are left in the positional references. Further convenience features are provided.</p>

<pre>
(plambda (values :3 :1))
==
(lambda (first second third)
  (declare (ignore second))
  (values third first))

(plambda (list* :2 :1 :rest))
==
(lambda (first second &amp;rest rest)
  (list* second first rest))

(plambda :rest (list :2 :1))
==
(lambda (first second &amp;rest rest)
  (declare (ignore rest))
  (list second first))


It's possible to specify a minimum number of required arguments:

(plambda :3 :2)
==
(lambda (first second third)
  (declare (ignore first third))
  second)

(plambda :2 :3) ; redundant minimum: 3 > 2.
==
(plambda :3)


Which also has the effect of "pushing back" the &amp;rest argument if there's one:

(plambda :3 (mapcar :1 :rest))
==
(lambda (first second third &amp;rest rest)
  (declare (ignore second third))
  (mapcar first rest))


The first argument to PLAMBDA is treated as a specification of the
minimum number of arguments only if it looks like a positional reference
and PLAMBDA was invoked with other arguments:

(plambda :2)
==
(lambda (first second)
  (declare (ignore first))
  second)


PLAMBDA accepts an implicit PROGN, not just one expression:

(plambda (print :1) :2)
==
(lambda (first second)
  (print first)
  second)


Also, PLAMBDA's :let "local special operator" allows one to "lift" parts of
its body outside the lambda to a LET without needing to name and then
refer to an explicit variable.

(plambda :2 (list :1 (:let (random))))
==
(let ((number (random)))
  (lambda (first second)
    (declare (ignore second))
    (list first number)))


Another feature is :cache, which is like :let except it computes the
associated form in its original lexical and dynamic context within the
lambda the first time its evaluation completes and returns the cached
value on subsequent evaluations.

(plambda (write :1 :base (:cache *print-base*)))
==
(let (base basep)
  (lambda (first)
    (write first :base (if basep
                           base
                           (prog1 (setf base *print-base*)
                             (setf basep t))))))

The consequences are undefined if the :let and :once local special
operators are nested within themselves or eachother:

(plambda (:let (:let 1))) ; undefined


PLAMBDA will treat any quoted expressions as opaque, and will treat
anything wrapped in the :quote local-special-form as opaque as well.

(plambda ':1)
==
(lambda () ':1)

(plambda () (:quote :1))
==
(lambda () :1)


Unfortunately, currently PLAMBDA won't do the right thing with some
expressions that are quoted via backquote (since there's no easy
portable way to walk backquoted expressions).

(plambda `(:1 ,:2))
==
[:1 will be erroneously replaced]


To use lambda-lift, simply (:import-from #:lambda-lift #:lift) from
your DEFPACKAGE. Don't (:use #:lambda-lift)! "Clashy" symbols might be
added to the lambda-lift package in the future.


positional-lambda should only be used to describe actually trivial
lambdas, usually no more than 3 lines long, and should not be used in
code returned by macros, because of "capture" issues. In particular,
due to the PLAMBDA macro's parsing model, it's not safe to nest multiple
invocations.

However, these are not practical limitations since as PLAMBDA's
expressions get bigger, the benefits of conciseness quickly fade out
to be replaced by the problems of implicitness, so hopefully one
wouldn't be tempted to use it in these scenarios anyway. The
implicitness is not a problem for suitably short PLAMBDA expressions
since the surrounding context provides enough contextual information,
and explicitly naming variables would then simply provide redundant
information.

PLAMBDA's deliberately simplistic "surface parsing" (and replacement)
strategy is conceptually and implementationally simple and robust, as
opposed to often-brittle "code-walking" where an attempt is made to
take into account the actual semantics of forms and operators, often
necessitating explicit support when new operators are introduced.
</pre>

      <p>Better documentation will have to wait after all, but you should be able to figure out things with <a href="https://github.com/Hexstream/positional-lambda/blob/master/README">the README</a> and some experimentation. There's also an <a href="examples.html">ugly and incomplete examples page</a> but it's mostly just the examples in the README with the actual macroexpansions instead of "what you'd write by hand".</p>

    </div>

    <div id="footer">
      <div>
        <a href="#" class="back-to-top">⬆</a>
        <span class="page-badge"><a href="http://validator.w3.org/check?uri=http%3A%2F%2Fwww.hexstreamsoft.com%2Fprojects%2Fpositional-lambda%2F"><span class="checkmark">✔</span> HTML5</a></span>
        <span class="page-badge"><a href="http://www.hexstreamsoft.com/README"><span class="checkmark">✔</span> Public Domain</a></span>
        <span class="page-badge"><a href="http://jigsaw.w3.org/css-validator/validator?uri=http%3A%2F%2Fwww.hexstreamsoft.com%2Fprojects%2Fpositional-lambda%2F"><span class="checkmark">✔</span> CSS3</a></span>
      </div>
    </div>

  </body>
</html>
